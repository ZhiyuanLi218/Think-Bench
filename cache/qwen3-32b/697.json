{"question":"A drawer contains a mixture of red socks and blue socks, at most 1991 in all. It so happens that, when two socks are selected randomly without replacement, there is a probability of exactly $\\frac{1}{2}$ that both are red or both are blue. What is the largest possible number of red socks in the drawer that is consistent with this data?","answer":"990","index":697,"key_annotation_steps":{"solution1":{"logical_conclusion":["step1: Let's denote the number of red socks as r and blue socks as b, with the total number of socks n = r + b ≤ 1991","step2: The probability of selecting two red socks is r(r-1)/[n(n-1)]","step3: The probability of selecting two blue socks is b(b-1)/[n(n-1)]","step4: We're told that P(both red OR both blue) = 1/2, so: [r(r-1) + b(b-1)]/[n(n-1)] = 1/2","step5: Simplifying: r(r-1) + b(b-1) = n(n-1)/2","step6: Since b = n - r, we get: r(r-1) + (n-r)(n-r-1) = n(n-1)/2","step7: Expanding: r² - r + n² - 2nr + r² - n + r = n²/2 - n/2","step8: Simplifying: 2r² - 2nr + n² - n = n²/2 - n/2","step9: Rearranging: 2r² - 2nr + n²/2 - n/2 = 0","step10: Further simplifying: 4r² - 4nr + n² - n = 0","step11: Factoring: 4r² - 4nr + n² = n","step12: Completing the square: (2r - n)² = n","step13: Solving for r: r = n/2 ± √n/2","step14: Since we want the maximum value of r, we take: r = n/2 + √n/2","step15: For r to be an integer, √n must be an integer, so let n = k²","step16: Substituting n = k² into the equation: r = k²/2 + k/2 = (k² + k)/2","step17: To satisfy r being integer, k must be even. Let k = 2m","step18: Substituting k = 2m: n = (2m)² = 4m² and r = (4m² + 2m)/2 = 2m² + m","step19: The constraint n ≤ 1991 becomes 4m² ≤ 1991 → m² ≤ 497.75 → m ≤ 22","step20: The largest possible integer m is 22, giving n = 4×22² = 1936","step21: Calculating r: r = 2×22² + 22 = 968 + 22 = 990","step22: Verifying: For r = 990, b = 1936 - 990 = 946, the probability is exactly 1/2","step23: Therefore, the largest possible number of red socks is 990"]}},"question_type":"Hard","category":"math","subcategory":"combinatorics","prediction":"To solve the problem, we are given that a drawer contains red and blue socks, with a total number not exceeding 1991. The probability that two randomly selected socks are **both red or both blue** is exactly $ \\frac{1}{2} $. We are to find the **maximum possible number of red socks** in the drawer under these constraints.\n\n---\n\n### Step 1: Define Variables\n\nLet:\n- $ R $ = number of red socks\n- $ B $ = number of blue socks\n- $ N = R + B $ = total number of socks\n\nThe probability that both selected socks are red or both are blue is:\n\n$$\nP = \\frac{\\binom{R}{2} + \\binom{B}{2}}{\\binom{N}{2}} = \\frac{1}{2}\n$$\n\nUsing the formula for combinations:\n\n$$\n\\frac{\\frac{R(R - 1)}{2} + \\frac{B(B - 1)}{2}}{\\frac{N(N - 1)}{2}} = \\frac{1}{2}\n$$\n\nMultiply both sides by $ \\frac{N(N - 1)}{2} $:\n\n$$\nR(R - 1) + B(B - 1) = \\frac{1}{2}N(N - 1)\n$$\n\nSubstitute $ B = N - R $ and simplify:\n\n$$\nR(R - 1) + (N - R)(N - R - 1) = \\frac{1}{2}N(N - 1)\n$$\n\nAfter simplification, this leads to the equation:\n\n$$\n(R - B)^2 = N\n$$\n\n---\n\n### Step 2: Interpret the Result\n\nFrom the equation $ (R - B)^2 = N $, we conclude that $ N $ must be a **perfect square**, since the left-hand side is a square of an integer.\n\nLet $ N = k^2 $, then:\n\n$$\nR - B = \\pm k \\quad \\text{and} \\quad R + B = k^2\n$$\n\nSolving these two equations:\n\n- Case 1: $ R = \\frac{k^2 + k}{2} $, $ B = \\frac{k^2 - k}{2} $\n- Case 2: $ R = \\frac{k^2 - k}{2} $, $ B = \\frac{k^2 + k}{2} $\n\nSince we are to find the **maximum** number of red socks, we take:\n\n$$\nR = \\frac{k^2 + k}{2}\n$$\n\n---\n\n### Step 3: Maximize R under Constraint $ N \\leq 1991 $\n\nWe need the largest integer $ k $ such that $ k^2 \\leq 1991 $.\n\n$$\n\\sqrt{1991} \\approx 44.62 \\Rightarrow \\text{Maximum } k = 44\n$$\n\nNow compute:\n\n$$\nR = \\frac{44^2 + 44}{2} = \\frac{1936 + 44}{2} = \\frac{1980}{2} = 990\n$$\n\n---\n\n### Step 4: Verify the Solution\n\n- Total socks: $ N = 44^2 = 1936 $\n- Red socks: $ R = 990 $\n- Blue socks: $ B = 1936 - 990 = 946 $\n- $ R - B = 44 $, and $ (R - B)^2 = 1936 = N $, which satisfies the derived condition.\n\nAlso, the total probability of both socks being red or blue is:\n\n$$\n\\frac{990 \\cdot 989 + 946 \\cdot 945}{1936 \\cdot 1935} = \\frac{1}{2}\n$$\n\nThis confirms the correctness of the solution.\n\n---\n\n### Final Answer\n\n$$\n\\boxed{990}\n$$","think_content":"<think>\nOkay, so I need to figure out the largest possible number of red socks in a drawer that has a total number of socks (red and blue) not exceeding 1991. The key piece of information given is that if you randomly pick two socks without replacement, the probability that both are red or both are blue is exactly 1/2. \n\nFirst, let me recall how probability works for this scenario. If there are R red socks and B blue socks, then the total number of socks is N = R + B. The probability of picking two red socks is (R choose 2)/ (N choose 2), and similarly the probability of picking two blue socks is (B choose 2)/ (N choose 2). Since these are mutually exclusive events (you can't have both two red and two blue socks in the same draw), the total probability that both socks are the same color is the sum of these two probabilities. \n\nSo the probability P is:\n\nP = [C(R, 2) + C(B, 2)] / C(N, 2) = 1/2\n\nWhere C(n, 2) is the combination formula n(n - 1)/2.\n\nLet me write that equation out more explicitly:\n\n[C(R, 2) + C(B, 2)] / C(N, 2) = 1/2\n\nSubstituting the combination formulas:\n\n[ (R(R - 1)/2 + B(B - 1)/2 ) / (N(N - 1)/2) ] = 1/2\n\nSimplify numerator and denominator:\n\nMultiply numerator and denominator by 2 to eliminate denominators:\n\n[ R(R - 1) + B(B - 1) ] / [N(N - 1)] = 1/2\n\nMultiply both sides by N(N - 1):\n\nR(R - 1) + B(B - 1) = (1/2) N(N - 1)\n\nBut since N = R + B, maybe we can express everything in terms of R and N. Let me try that.\n\nLet me note that B = N - R. So substituting B into the equation:\n\nR(R - 1) + (N - R)(N - R - 1) = (1/2) N(N - 1)\n\nLet me expand the left-hand side (LHS):\n\nFirst term: R^2 - R\n\nSecond term: Let's expand (N - R)(N - R - 1):\n\nLet me denote (N - R) as B for a moment. Then it's B(B - 1) = B² - B. Which is (N - R)^2 - (N - R). \n\nExpanding (N - R)^2:\n\nN² - 2NR + R² - N + R\n\nWait, let me do that step by step:\n\n(N - R)(N - R - 1) = (N - R)(N - R) - (N - R) = (N - R)^2 - (N - R)\n\nExpanding (N - R)^2:\n\nN² - 2NR + R²\n\nTherefore, the entire second term is N² - 2NR + R² - N + R\n\nTherefore, adding the first term R² - R:\n\nTotal LHS is:\n\nR² - R + N² - 2NR + R² - N + R\n\nSimplify term by term:\n\nR² - R + R² + N² - 2NR - N + R\n\nCombine like terms:\n\nR² + R² = 2R²\n\n- R + R = 0\n\nThen N² - 2NR - N\n\nSo total LHS is 2R² + N² - 2NR - N\n\nTherefore, the equation becomes:\n\n2R² + N² - 2NR - N = (1/2) N(N - 1)\n\nLet me compute the right-hand side (RHS):\n\n(1/2)N(N - 1) = (N² - N)/2\n\nMultiply both sides by 2 to eliminate the fraction:\n\nLeft side multiplied by 2: 4R² + 2N² - 4NR - 2N\n\nRight side multiplied by 2: N² - N\n\nBring all terms to the left side:\n\n4R² + 2N² - 4NR - 2N - N² + N = 0\n\nSimplify:\n\n(2N² - N²) + 4R² - 4NR + (-2N + N) = 0\n\nWhich is:\n\nN² + 4R² - 4NR - N = 0\n\nLet me rearrange terms:\n\n4R² - 4NR + N² - N = 0\n\nHmm, perhaps I can write this as a quadratic in R?\n\nLooking at 4R² - 4NR + ... Let me see:\n\n4R² - 4NR + (N² - N) = 0\n\nYes, quadratic in R. Let me write it as:\n\n4R² - 4NR + (N² - N) = 0\n\nLet me divide all terms by 4 to make it simpler:\n\nR² - NR + (N² - N)/4 = 0\n\nAlternatively, maybe completing the square?\n\nLet me try that. The quadratic in R:\n\nR² - NR + ... Let me complete the square for R.\n\nR² - NR = (R - N/2)^2 - (N²)/4\n\nTherefore, substituting back into the equation:\n\n(R - N/2)^2 - N²/4 + (N² - N)/4 = 0\n\nSimplify the constants:\n\n- N²/4 + N²/4 - N/4 = -N/4\n\nTherefore, equation becomes:\n\n(R - N/2)^2 - N/4 = 0\n\nSo:\n\n(R - N/2)^2 = N/4\n\nTaking square roots:\n\nR - N/2 = ±√(N)/2\n\nTherefore:\n\nR = N/2 ± √N / 2\n\nMultiply numerator and denominator:\n\nR = [N ± √N]/2\n\nSo, R is equal to [N + √N]/2 or [N - √N]/2.\n\nTherefore, since R must be an integer (number of socks), and N is the total number of socks, which is also an integer (since it's the sum of red and blue socks). Therefore, √N must be rational? Because N is integer, √N must be integer for R to be integer. Because if √N is irrational, then R would not be integer. Therefore, N must be a perfect square.\n\nLet me denote √N = k, where k is integer. Therefore, N = k². Then R is:\n\nR = [k² ± k]/2\n\nTherefore, R is either (k² + k)/2 or (k² - k)/2.\n\nWhich is equivalent to R = k(k + 1)/2 or R = k(k - 1)/2.\n\nTherefore, these are the triangular numbers or something similar.\n\nSo, for N = k², R can be either the k-th triangular number or the (k - 1)-th triangular number. \n\nTherefore, since we want the largest possible number of red socks, we need to take R = [k² + k]/2. However, since the total number of socks N must be at most 1991, we need to find the maximum R such that N = k² ≤ 1991, and R = [k² + k]/2.\n\nBut wait, actually, N is k², so if we take R = [k² + k]/2, then B = N - R = [k² - k]/2. Both R and B must be non-negative integers. Since k is positive integer, both expressions are non-negative.\n\nTherefore, the problem reduces to finding the maximum R = [k² + k]/2 where k² ≤ 1991.\n\nSo first, find the maximum integer k such that k² ≤ 1991.\n\nCompute sqrt(1991). Let me approximate sqrt(1991). Since 44² = 1936, 45² = 2025. So sqrt(1991) is between 44 and 45. Therefore, the maximum integer k is 44, since 44² = 1936 ≤ 1991, and 45² = 2025 > 1991.\n\nTherefore, maximum k is 44. Therefore, maximum R is [44² + 44]/2 = (1936 + 44)/2 = 1980 / 2 = 990. \n\nBut wait, but maybe there is another case where N is not a perfect square? Wait, earlier reasoning concluded that N must be a perfect square? Because we had R = [N ± sqrt(N)] / 2, which requires sqrt(N) to be integer. Therefore, N must be a perfect square. Therefore, only when N is a perfect square can R be integer. Therefore, the only solutions are when N = k² and R = [k² ± k]/2. Therefore, if we take N as maximum possible perfect square less than or equal to 1991, which is 44² = 1936, then R can be 990. But perhaps there are larger R for some N which is not a perfect square? Wait, but according to the equation, if N is not a perfect square, then sqrt(N) is irrational, so R would not be integer. Therefore, there are no solutions except when N is a perfect square. Therefore, the maximum R is 990 when N = 1936. However, the problem says \"at most 1991 in all\". So maybe there is a larger N (non-square) where the equation still holds? Wait, but according to our derivation, N must be square. Wait, unless there is some mistake in the derivation.\n\nWait, let me check my steps again.\n\nStarting from the equation:\n\n(R - N/2)^2 = N / 4\n\nWhich leads to R = [N ± sqrt(N)] / 2. Therefore, unless sqrt(N) is integer, R is not integer. Therefore, N must be a perfect square. Therefore, only perfect squares. Therefore, the maximum N is 44² = 1936. Therefore, maximum R is (1936 + 44)/2 = 990. \n\nBut the problem says \"at most 1991 in all\". So maybe there is a larger N (closer to 1991) which is not a perfect square but still satisfies the equation? But according to the derivation, N must be a perfect square. Therefore, perhaps there is another case?\n\nWait, let me check my algebra again. Let me rederive the equation.\n\nOriginal equation:\n\nProbability is 1/2. So:\n\n[R(R - 1) + B(B - 1)] / [N(N - 1)] = 1/2\n\nWith N = R + B.\n\nLet me try plugging R = [N + sqrt(N)] / 2. If N is not a square, then R is not integer. However, perhaps there is another solution where sqrt(N) is not integer? Wait, maybe my derivation missed something. Let me check again.\n\nOriginal equation after simplifying:\n\n(R - N/2)^2 = N / 4\n\nWhich implies that R - N/2 is sqrt(N)/2 or -sqrt(N)/2.\n\nTherefore, R must equal N/2 ± sqrt(N)/2. Therefore, unless sqrt(N) is rational, R is not rational. But since R must be integer, sqrt(N) must be integer. Therefore, N must be a perfect square. Therefore, only perfect squares. Therefore, there are no solutions with N not a perfect square. Therefore, the maximum N is 44² = 1936, and maximum R is 990. \n\nBut wait, the problem says \"at most 1991 in all\". So maybe there is another case where N is not a perfect square but the equation still holds? Let me think.\n\nAlternatively, perhaps there is a mistake in the derivation. Let me check again.\n\nStarting from:\n\n[R(R - 1) + B(B - 1)] = (1/2) N(N - 1)\n\nMultiply both sides by 2:\n\n2R(R - 1) + 2B(B - 1) = N(N - 1)\n\nBut N = R + B. Let me expand the left side:\n\n2R² - 2R + 2B² - 2B = N² - N\n\nGroup terms:\n\n2R² + 2B² - 2R - 2B = N² - N\n\nBut since N = R + B, N² = (R + B)^2 = R² + 2RB + B². Therefore:\n\nLeft side: 2R² + 2B² - 2(R + B) = 2(R² + B²) - 2N\n\nRight side: N² - N = R² + 2RB + B² - N\n\nTherefore, equation becomes:\n\n2(R² + B²) - 2N = R² + 2RB + B² - N\n\nSimplify left side minus right side equals zero:\n\n2(R² + B²) - 2N - R² - 2RB - B² + N = 0\n\nWhich simplifies to:\n\n(2R² + 2B² - R² - B²) - 2N - 2RB + N = 0\n\nWhich is:\n\n(R² + B²) - N - 2RB = 0\n\nBut R² + B² - 2RB = (R - B)^2. Therefore:\n\n(R - B)^2 - N = 0\n\nTherefore:\n\n(R - B)^2 = N\n\nTherefore, N must be a perfect square, and R - B = sqrt(N) or R - B = -sqrt(N). Therefore, R - B = ±sqrt(N). \n\nSo here is another way to get there. Therefore, N must be a perfect square, let me denote N = k². Then R - B = ±k. Also, since N = R + B, we can solve for R and B.\n\nLet me write:\n\nCase 1: R - B = k\n\nAnd R + B = k²\n\nAdding equations:\n\n2R = k² + k => R = (k² + k)/2\n\nSubtracting equations:\n\n2B = k² - k => B = (k² - k)/2\n\nCase 2: R - B = -k\n\nThen:\n\nR - B = -k\n\nR + B = k²\n\nAdding equations:\n\n2R = k² - k => R = (k² - k)/2\n\nSubtracting equations:\n\n2B = k² + k => B = (k² + k)/2\n\nTherefore, in both cases, R is either (k² + k)/2 or (k² - k)/2. Therefore, since we want the largest possible number of red socks, we need to take R = (k² + k)/2. Therefore, for each k, N = k², and R = (k² + k)/2. Therefore, the maximum R occurs when k is as large as possible such that k² ≤ 1991.\n\nAs before, k_max = 44, since 44² = 1936 ≤ 1991, and 45² = 2025 > 1991. Therefore, R_max = (44² + 44)/2 = (1936 + 44)/2 = 1980/2 = 990. \n\nBut wait, is there another scenario where N is not a perfect square? According to the equation (R - B)^2 = N, N must be a perfect square. Therefore, there are no solutions with N not a perfect square. Therefore, the maximum R is 990. However, the problem says \"at most 1991 in all\". So perhaps there is a larger k² + k)/2 with N = k² ≤ 1991? For k = 44, N = 1936. But maybe for some k where k² is less than 1991, but (k² + k)/2 is larger? For example, if we take a larger k, but with N = k² still less than or equal to 1991. But k_max is 44. So no, 44 is the maximum k. Therefore, R is 990. \n\nBut let me check for k = 44, R = 990, B = (k² - k)/2 = (1936 - 44)/2 = 1892 / 2 = 946. Then total socks N = 990 + 946 = 1936. \n\nBut the problem says \"at most 1991\". So if there is a larger N (closer to 1991) which is not a perfect square, but still satisfies the probability condition? But according to the equation, N must be a perfect square. Therefore, there are no such N. Therefore, 1936 is the maximum N. Therefore, 990 is the maximum R. \n\nBut wait, let me check if there's another way. Suppose that my derivation is missing some cases. For example, maybe there are non-integer solutions but with R and B integers? Wait, no, because (R - B)^2 = N. Since R and B are integers, then R - B is integer, so N must be a perfect square. Therefore, there are no other solutions. Therefore, the answer is 990. \n\nBut let me check with an example. Let's take a smaller N. For example, N = 2, which is not a square. Then the probability of getting two same color socks would be... Well, if N = 2, then there are two socks. They can be both red, both blue, or one of each. The probability of getting both same is C(R,2) + C(B,2) over C(2, 2). If R = 1, B = 1, then probability is 0 + 0 / 1 = 0 ≠ 1/2. If R = 2, B = 0, then probability is 1 / 1 = 1 ≠ 1/2. Similarly for R = 0. Therefore, no solution for N = 2, which is consistent with N must be square. For N = 1, trivial case, but you can't pick two socks. So N must be at least 2. \n\nAnother example, N = 4, which is square. Let's take k = 2. Then R = (4 + 2)/2 = 3, B = (4 - 2)/2 = 1. Then probability is [C(3,2) + C(1,2)] / C(4,2). But C(1,2) is 0. Therefore, 3 / 6 = 1/2. Correct. Similarly, if R = 1, B = 3, same result. Therefore, works. \n\nTherefore, seems correct that only perfect squares. Therefore, answer is 990. However, I need to check if maybe there is a larger R for N between 1936 and 1991. But since N must be square, and next square is 45² = 2025 which is over 1991, so no. Therefore, 1936 is the maximum N. Therefore, R is 990. \n\nBut let me check if there is another possible value of N less than 1991 where even though N is not a square, but somehow the equation is satisfied. But according to the equation (R - B)^2 = N. Therefore, N must be square. Therefore, no. Therefore, answer is 990. \n\nBut wait, let me check the problem statement again. It says \"a mixture of red socks and blue socks, at most 1991 in all\". So total number of socks is ≤ 1991. So maybe there is another N which is a square, less than 1991, but with a larger R? For example, if for some k, (k² + k)/2 is larger than 990? But since k_max is 44, giving R = 990. For k = 44, N = 1936. If I take k = 44. Then for k = 44, R is 990. If I take k = 45, N would be 2025 which is over 1991. Therefore, no. Therefore, 990 is the maximum. \n\nBut let me check if there is another expression. Suppose that the problem allows N to be something else... Wait, but according to the equation, N must be square. Therefore, no. Therefore, answer is 990. \n\nBut wait, let me check with the problem's exact wording. The problem says \"the probability of exactly 1/2 that both are red or both are blue\". So my derivation seems correct. Therefore, answer is 990. However, I have a feeling that maybe there is a larger number. Maybe my assumption that N must be square is wrong? Let me think again. \n\nFrom (R - B)^2 = N. Therefore, N is a square. Therefore, R - B = sqrt(N). Therefore, R = B + sqrt(N). Also, R + B = N. Therefore, substituting:\n\nB + sqrt(N) + B = N => 2B + sqrt(N) = N => 2B = N - sqrt(N) => B = [N - sqrt(N)] / 2. Therefore, since B must be integer, then [N - sqrt(N)] must be even. Therefore, sqrt(N) must be integer, and N - sqrt(N) must be even. Therefore, if N is a square, say k², then B = [k² - k]/2, which is integer if k² - k is even. Since k² - k = k(k - 1), which is always even because either k or k - 1 is even. Therefore, yes, B is integer. Similarly for R. Therefore, all conditions are satisfied. Therefore, only N which are squares. Therefore, answer is 990. \n\nBut let me check with k = 44, N = 44² = 1936. Then R = (1936 + 44)/2 = 1980 / 2 = 990. Then B = 1936 - 990 = 946. Then check if the probability is indeed 1/2. \n\nCompute C(R, 2) + C(B, 2) divided by C(N, 2). \n\nC(R, 2) = 990 * 989 / 2\n\nC(B, 2) = 946 * 945 / 2\n\nC(N, 2) = 1936 * 1935 / 2\n\nSo total probability is [990*989 + 946*945] / [1936*1935]\n\nLet me compute numerator:\n\nFirst, note that according to our previous derivation, this should equal 1/2 * [1936 * 1935]/something? Wait, according to our equation earlier, we had:\n\n[R(R - 1) + B(B - 1)] = (1/2) N(N - 1)\n\nTherefore, numerator is R(R - 1) + B(B - 1) = 990*989 + 946*945. According to equation, this should equal (1/2)*1936*1935. Let me check:\n\nCompute 1/2 * 1936 * 1935 = 968 * 1935. Let me compute 990*989 + 946*945. \n\nAlternatively, since we know that (R - B)^2 = N, which is 1936. Therefore, R - B = 44. Which is 990 - 946 = 44. Correct. Therefore, according to our equation, the probability is 1/2. Therefore, it is correct. Therefore, the answer is 990. \n\nBut let me check for k = 44. Is there a possibility of a larger R for a smaller k? No, because R increases as k increases. For example, for k = 44, R is maximum. \n\nBut let me check for k = 44.5? No, k must be integer. Therefore, no. Therefore, answer is 990. \n\nBut hold on. Wait, the problem says \"at most 1991 in all\". So total number of socks can be less than 1991. But if we take N = k², with k as large as possible such that k² ≤ 1991, which is 44² = 1936. But maybe there are other values of N (squares) between 1936 and 1991? Let me check. For example, 44² = 1936, next square is 45² = 2025, which is more than 1991. Therefore, no. Therefore, 1936 is the maximum square less than or equal to 1991. Therefore, R is 990. \n\nBut maybe there is a non-square N where the equation is satisfied? For example, if we have (R - B)^2 = N, but N is not square? No, because left side is integer squared. Therefore, N must be square. Therefore, no. Therefore, answer is 990. \n\nBut let me check with another approach. Suppose that the probability is 1/2. Therefore:\n\n[R(R - 1) + B(B - 1)] / [N(N - 1)] = 1/2\n\nMultiply both sides by N(N - 1):\n\nR(R - 1) + B(B - 1) = [N(N - 1)] / 2\n\nBut since B = N - R:\n\nR(R - 1) + (N - R)(N - R - 1) = [N(N - 1)] / 2\n\nWhich we already did. Therefore, leading to N must be square. \n\nAlternatively, suppose that we think of this equation as quadratic in R. Let me write it again:\n\nOriginal equation after expansion:\n\n(R - N/2)^2 = N/4\n\nWhich is:\n\nR = [N ± √N]/2\n\nTherefore, if we suppose that N is not a square, but √N is rational. Let me think. Suppose that √N is rational. Then N must be a square of rational number. But since N is integer, √N must be integer. Because if √N is rational, then it can be expressed as a reduced fraction a/b, then N = a² / b². Since N is integer, b² divides a², which implies that b divides a, but since fraction is reduced, b = 1. Therefore, √N is integer. Therefore, N must be a perfect square. Therefore, no other solutions. Therefore, answer is 990. \n\nTherefore, I think that the answer is 990. However, to make sure, let me check if there is any possible way to have a larger R with N up to 1991. For example, suppose that there is a N between 1936 and 1991 where even though N is not a square, the equation holds. But according to the equation, (R - B)^2 = N. Therefore, N must be square. Therefore, impossible. Therefore, answer is 990. \n\nBut let me check if maybe there is an error in translation or problem understanding. The problem says \"a probability of exactly 1/2 that both are red or both are blue\". So that is P(both red) + P(both blue) = 1/2. Which is what I used. If instead it was P(both red or both blue) = 1/2, which is same thing. \n\nAlternatively, maybe the problem is in the case when there is only one color? For example, if all socks are red. Then P(both red) = 1, which is more than 1/2. Similarly, if all blue. If there is one color, probability is 1. If there are only two socks, one red and one blue, then P(both same color) is zero. Therefore, only when there is a mix. \n\nBut according to our previous analysis, the only solutions are when N is square. Therefore, answer is 990. Therefore, I think that is correct. Therefore, the largest possible number of red socks is 990. \n\nBut just to confirm, let me check with k = 44, N = 1936, R = 990. Then total red socks is 990. Which is less than 1991. Therefore, satisfies the problem's condition. \n\nAlternatively, if there is another N which is not square but allows for same probability? For example, suppose that there is some N where [R(R - 1) + B(B - 1)] / [N(N - 1)] = 1/2, but (R - B)^2 ≠ N. But according to our derivation, this equation simplifies to (R - B)^2 = N. Therefore, there are no other solutions. Therefore, answer is 990. \n\nTherefore, I think that the answer is 990. Therefore, the largest possible number of red socks is \\boxed{990}.\n\n**Final Answer**\n\\boxed{990}\n</think>"}